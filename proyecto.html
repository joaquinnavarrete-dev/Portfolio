<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Detalle del Proyecto</title>
  <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@300;600;800&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="css/proyecto.css">
</head>

<body class="dark-mode">

  <button id="theme-toggle" class="theme-btn" aria-label="Cambiar tema">
    <img id="theme-icon" src="img/sun.png" alt="Sol">
  </button>

  <a href="index.html" class="back-btn">← Volver al Portfolio</a>

  <main class="detalle-container">
    
    <header class="detalle-header">
      <h1 id="titulo-proyecto">Cargando...</h1>
      <img id="img-principal" src="" alt="Portada" class="main-img-detalle">
    </header>

    <section class="detalle-info">
      <p id="descripcion-proyecto"></p>
      <div class="links-proyecto" id="links-container"></div>
    </section>

    <section class="detalle-stack">
      <h2>Tecnologías Usadas</h2>
      <div class="tech-stack-detalle" id="stack-container"></div>
    </section>

    <section class="detalle-galeria">
      <h2>Capturas de Pantalla</h2>
      <div class="gallery-grid" id="galeria-container"></div>
    </section>

  </main>

  <a href="index.html" class="back-btn2">← Volver al Portfolio</a>

  <script>
    /* --- 1. BASE DE DATOS DE PROYECTOS --- */
    const proyectosData = {
      "filmfinder": {
        titulo: "FilmFinder",
        descripcion: "Plataforma web Full Stack diseñada para la exploración de catálogos cinematográficos. El sistema permite a los usuarios buscar películas en tiempo real, aplicar filtros por categoría o calificación, y acceder a fichas técnicas detalladas. Incluye un módulo social para dejar comentarios y un formulario de contacto funcional. UI diseñada en Figma.",
        // Rutas corregidas
        imgPrincipal: "img/FilmFinder.png", 
        galeria: [
          "img/inicio-film-finderpng.png",
          "img/filmfinder_pagina_pelicula.png", 
          "img/film-finder-catalogo.png"
        ],
        tecnologias: [
          { nombre: "Python", icono: "icons/python.png" },
          { nombre: "Flask", icono: "icons/python.png" }, 
          { nombre: "JavaScript", icono: "icons/js.png" },
          { nombre: "HTML5", icono: "icons/html5.png" },
          { nombre: "CSS3", icono: "icons/css3.png" },
          { nombre: "Figma", icono: "icons/figma.png" }
        ],
      },
      
      "museo": {
        titulo: "Museo del Ciclomotor",
        descripcion: "Sistema de software desarrollado para tótems inteligentes interactivos dentro del museo. La aplicación gestiona la base de datos completa de la colección, permitiendo el ABM (Alta, Baja y Modificación) de los vehículos. Cuenta con un sistema de 'bajas lógicas' para recuperar ítems eliminados, buscador por código interno y un panel de edición robusto. Los visitantes pueden interactuar con las pantallas para visualizar la ficha técnica, historia y galería de fotos de cada ciclomotor.",
        // Rutas corregidas
        imgPrincipal: "img/Logo-Museo.png", 
        galeria: [
          "img/pantalla-inicio-museo.png",    
          "img/pagina-modelo-museo.png",    
          "img/carga-items-museo.png",      
          "img/pantalla-bloqueo-museo.png", 
        ],
        tecnologias: [
          { nombre: "JavaScript", icono: "icons/js.png" },
          { nombre: "HTML5", icono: "icons/html5.png" },
          { nombre: "CSS3", icono: "icons/css3.png" },
          { nombre: "SQL", icono: "icons/Sql.png" } 
        ],
      },

      "snackway": {
        titulo: "SnackWay",
        descripcion: "Plataforma e-commerce gastronómica diseñada para optimizar la experiencia de pedido online. El sistema cuenta con un catálogo interactivo de productos (hamburguesas, bebidas, etc.), carrito de compras y un módulo de autenticación de usuarios. Incluye un panel administrativo ('Back Office') que permite la carga y gestión de productos en tiempo real. La interfaz destaca por su diseño vibrante y navegación intuitiva.",
        // Rutas corregidas
        imgPrincipal: "img/logo-snackway.png", 
        galeria: [
          "img/snackway-home.jpg",     
          "img/snackway-captura1.png",     
          "img/snackway-captura2.png",   
          "img/snackway-captura3.png",   
          "img/snackway-login.png"        
        ],
        tecnologias: [
          { nombre: "HTML5", icono: "icons/html5.png" },
          { nombre: "CSS3", icono: "icons/css3.png" },
          { nombre: "JavaScript", icono: "icons/js.png" },
          { nombre: "Figma", icono: "icons/figma.png" }
        ],
      },
    };

    /* --- 2. LÓGICA DEL MODO OSCURO (INVERTIDA) --- */
    const toggleButton = document.getElementById('theme-toggle');
    const themeIcon = document.getElementById('theme-icon');
    const body = document.body;

    toggleButton.addEventListener('click', (event) => {
      const toggleLogic = () => {
        const isDark = body.classList.toggle('dark-mode');
        
        if (isDark) {
          // Rutas corregidas
          themeIcon.src = "img/sun.png"; 
          themeIcon.alt = "Sol";
        } else {
          // Rutas corregidas
          themeIcon.src = "img/moon.png";
          themeIcon.alt = "Luna";
        }
      };

      if (!document.startViewTransition) {
        toggleLogic();
        return;
      }

      const x = event.clientX;
      const y = event.clientY;
      const endRadius = Math.hypot(Math.max(x, innerWidth - x), Math.max(y, innerHeight - y));

      const transition = document.startViewTransition(() => {
        toggleLogic();
      });

      transition.ready.then(() => {
        document.documentElement.animate(
          { clipPath: [`circle(0px at ${x}px ${y}px)`, `circle(${endRadius}px at ${x}px ${y}px)`] },
          { duration: 500, easing: 'ease-in-out', pseudoElement: '::view-transition-new(root)' }
        );
      });
    });

    /* --- 3. LÓGICA DE CARGA DE DATOS --- */
    const params = new URLSearchParams(window.location.search);
    let id = params.get('id');

    if (id === "2") id = "museo";
    if (id === "3") id = "snackway";

    console.log("ID procesado:", id);

    if (id && proyectosData[id]) {
      const proyecto = proyectosData[id];
      
      document.getElementById('titulo-proyecto').innerText = proyecto.titulo;
      document.getElementById('descripcion-proyecto').innerText = proyecto.descripcion;
      
      const imgMain = document.getElementById('img-principal');
      imgMain.src = proyecto.imgPrincipal;
      imgMain.style.display = 'block'; 
      imgMain.onerror = function() { 
          console.error("No se encontró la imagen:", proyecto.imgPrincipal);
      };

      const galeriaContainer = document.getElementById('galeria-container');
      if(proyecto.galeria && proyecto.galeria.length > 0) {
          proyecto.galeria.forEach(imgSrc => {
            const img = document.createElement('img');
            img.src = imgSrc;
            galeriaContainer.appendChild(img);
          });
      } else {
          document.querySelector('.detalle-galeria').style.display = 'none';
      }

      const stackContainer = document.getElementById('stack-container');
      if(proyecto.tecnologias && proyecto.tecnologias.length > 0) {
          proyecto.tecnologias.forEach(tech => {
            const span = document.createElement('span');
            span.className = 'tech-badge';
            span.innerHTML = `<img src="${tech.icono}" style="width:20px; vertical-align:middle; margin-right:5px"> ${tech.nombre}`;
            stackContainer.appendChild(span);
          });
      }

      const linksContainer = document.getElementById('links-container');
      linksContainer.innerHTML = ''; 
      
      if (proyecto.repoLink) {
        linksContainer.innerHTML += `<a href="${proyecto.repoLink}" target="_blank" class="cta-small">Ver Repositorio</a>`;
      }
      if (proyecto.demoLink) {
        linksContainer.innerHTML += `<a href="${proyecto.demoLink}" target="_blank" class="cta-small outline">Ver Demo</a>`;
      }

    } else {
      console.error("ID no encontrado en la base de datos:", id);
      document.querySelector('.detalle-container').innerHTML = `
        <div style="text-align:center;">
            <h1 style="color:var(--text-color);">⚠️ Proyecto no encontrado</h1>
            <p style="color:var(--text-color);">El ID "${id}" no existe en la base de datos.</p>
            <a href="index.html" class="back-btn" style="float:none;">Volver al inicio</a>
        </div>
      `;
    }
  </script>

</body>
</html>